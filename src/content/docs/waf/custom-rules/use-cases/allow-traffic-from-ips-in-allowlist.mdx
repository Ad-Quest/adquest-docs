---
pcx_content_type: configuration
title: Allow traffic from IP addresses in allowlist only
head:
  - tag: title
    content: Allow traffic from IP addresses in allowlist only
---

import { Steps } from "~/components";

This example blocks incoming requests from IP addresses that are not present in an allowlist (defined using an [IP list](/waf/tools/lists/custom-lists/#ip-lists)).

<Steps>

1.  [Create an IP list](/waf/tools/lists/create-dashboard/) with the IP addresses for which you want to allow access.<br/>
    For example, create an IP list named `allowed_ips` with one or more IP addresses. For more information on the accepted IP address formats, refer to [IP lists](/waf/tools/lists/custom-lists/#ip-lists).

2.  [Create a custom rule](/waf/custom-rules/create-dashboard/) blocking any requests from IPs not present in the list you created (`allowed_ips` in the current example).
    - **When incoming requests match**:

      | Field             | Operator       | Value         |
      | ----------------- | -------------- | ------------- |
      | IP Source Address | is not in list | `allowed_ips` |

      If you are using the Expression Editor:<br/>
      `(not ip.src in $allowed_ips)`

    - **Action**: _Block_

3.  (Optional) Update your expression with any extra filters, like blocking non-allowlisted IPs only for specific URI paths:

    | Field             | Operator       | Value         |     |
    | ----------------- | -------------- | ------------- | --- |
    | IP Source Address | is not in list | `allowed_ips` | And |
    | URI Path          | wildcard       | `/admin/*`    |     |

    If you are using the Expression Editor:<br/>
    `(not ip.src in $allowed_ips and http.request.uri.path wildcard "/admin/*")`

</Steps>

## Other resources

- [Use case: Require known IP addresses in site admin area](/waf/custom-rules/use-cases/site-admin-only-known-ips/)
- [Available skip options](/waf/custom-rules/skip/options/)
