---
title: Allow policies
pcx_content_type: how-to
sidebar:
  order: 1
---

import { Example, Details } from "~/components"

Email Security allows you to configure allow policies. An allow policy exempts messages that match certain patterns from normal detection scanning.

To configure allow policies:

1. Log in to [Zero Trust](https://one.dash.cloudflare.com/).
2. Select **Email Security**.
3. Select **Settings**, then go to **Detection settings** > **Allow policies**.
4. On the **Detection settings** page, select **Add a policy**.
5. On the **Add an allow policy** page, enter the policy information:
   - **Input method**: Choose between **Manual input**, and **Uploading an allow policy**:
       - **Manual input**:
           - **Action**: Select one of the following to choose how Email Security will handle messages that match your criteria:
               - **Trust sender**: Messages will bypass all detections and link following.
               - **Exempt recipient**: Message to this recipient will bypass all detections.
               - **Accept sender**: Messages from this sender will be exempted from Spam, Spoof, and Bulk dispositions. Refer to [Allow policy configuration use cases](#use-case-1) for use case examples on how to configure allow policies for accept sender.
       - **Rule type**: Specify the scope of your policy. Choose one of the following:
           - **Email addresses**: Must be a valid email.
           - **IP addresses**: Can only be IPv4. IPv6 and CIDR are invalid entries.
           - **Domains**: Must be a valid domain.
           - **Regular expressions**: Must be valid Java expressions. Regular expressions are matched with fields related to the sender email address (envelope from, header from, reply-to), the originating IP address, and the server name for the email.
     - **(Recommended) Sender verification**: This option enforces DMARC, SPF, or DKIM authentication. If you choose to enable this option, Email Security will only honor policies that pass authentication.
       - **Notes**: Provide additional information about your allow policy.
   - **Uploading an allow policy**: Upload a file no larger than 150 KB. The file can only contain `Pattern`, `Pattern Type`, `Verify Email`, `Trusted Sender`, `Exempt Recipient`, `Acceptable Sender`, `Notes` fields. The first row must be a header row. Refer to [CSV uploads](/cloudflare-one/email-security/detection-settings/allow-policies/#csv-uploads) for an example file.
6. Select **Save**.

<Details header="Allow policy configuration use cases">
    
The following use cases show how you could configure allow policies for accept sender.

### Use case 1

<Example title="Company receives emails from third-party providers not used internally. These emails are sent from the service provider, and Email Security gives these emails an incorrect disposition.">
    This use case can affect companies such as Shopify, PayPal, and Docusign.

    To solve this:

    1. Create a [team submission](/cloudflare-one/email-security/email-monitoring/search-email/#team-submissions).
    2. Inform your Cloudflare contact about the escalation.
    3. Do not set up allow policies or blocked senders. In this use case, configuring allow policies will create a security gap. Setting up blocked senders will block legitimate emails from providers such as Shopify, PayPal, and Docusign.
</Example>

### Use case 2


<Example title="Company receives emails via third-party providers that are used internally. These emails are sent from the company's custom domain, but Email Security marks these emails as bulk, spam, or spoof.">

  This use case can cause the emails you want to receive to follow the auto-moves rules you set up. This use case affects emails from internal tools (such as Salesforce, Atlassian, and Figma) that are given an incorrect disposition.

  To solve this, when you add an allow policy in the Zero Trust dashboard:
  
  1. Choose **Accept sender**.
  2. Verify that **Sender verification (recommended)** is turned on.
  
</Example>


### Use case 3

<Example title="Company receives emails via third-party providers that are used internally. These emails are sent from the company's custom domain, but Email Security marks these emails as bulk, spam, or spoof. The custom email domain does not support DMARC, SPF, or DKIM, and would fail Sender Verification.">

  This use case impacts the emails from internal tools (such as Salesforce, Atlassian, and Figma) that are given an incorrect disposition.

  To solve this, when you add an allow policy in the Zero Trust dashboard:

  1. Choose **Accept sender** based on the static IP you own.
  2. Ensure that **Sender verification (recommended)** is turned off.

  :::caution
  Do not use email addresses or email domains for this policy as they can be easily spoofed without **Sender Verification (Recommended)** enabled.
  :::
 
</Example>

</Details>

### CSV uploads

You can upload a file no larger than 150 KB. The file can only contain `Pattern`, `Pattern Type`, `Verify Email`, `Trusted Sender`, `Exempt Recipient`, `Acceptable Sender`, `Notes`. The first row must be a header row.

An example file would look like this:

```txt
Pattern, Pattern Type, Verify Email, Trusted Sender, Exempt Recipient, Acceptable Sender, Notes
whale@notaphish.com, EMAIL, true, true, false, true, not a phish
```

## Export allow policies

To export a list of allow policies:

1. On the **Detection settings** page, select the allow policies you want to export.
2. Select **Action**.
3. Select **Export to CSV**.

## Edit allow policy

To edit an allow policy:

1. On the **Detection settings** page, select the allow policy you want to edit.
2. Select the three dots > **Edit**.
3. Edit the allow policy.
4. Select **Save**.

## Delete allow policy

To delete an allow policy:

1. On the **Detection settings** page, select the allow policy you want to delete.
2. Select the three dots > **Delete**.
3. On the pop-up message, select **Delete**.

To delete multiple allow policies at once:

1. On the **Detection settings** page, select the allow policies you want to delete.
2. Select **Action**.
3. Select **Delete**. 