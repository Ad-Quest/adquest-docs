---
pcx_content_type: how-to
title: TanStack Start
sidebar:
  order: 7
head: []
tags: ["full-stack"]
description: Create a TanStack Start application and deploy it to Cloudflare Workers.
---

import {
	Badge,
	Description,
	InlineBadge,
	Render,
	PackageManagers,
	Steps,
	WranglerConfig,
} from "~/components";

[TanStack Start](https://tanstack.com/start) is a full-stack framework for building web applications. It comes with features like server-side rendering, streaming, server functions, bundling, and more. In this guide, you learn to deploy a TanStack Start application to Cloudflare Workers.

## Creating a new TanStack Start application

To create a TanStack Start application, run the following command:

<PackageManagers
	type="create"
	pkg="cloudflare@latest"
	args="my-tanstack-start-app --framework=tanstack-start"
/>

After you have created your project, run the following command in the project directory to start a local development server. This will allow you to preview your project locally during development.

<PackageManagers type="run" args="dev" />

## Configuring an existing TanStack Start application

If you have an existing TanStack Start application, you can configure it to run on Cloudflare Workers by following these steps:

<Steps>
1. Add the `wrangler.jsonc` configuration file to the root of your project with the following content:
		<WranglerConfig>
    ```toml
    	name = "<YOUR_PROJECT_NAME>"
    	compatibility_date = "$today"
    	compatibility_flags = ["nodejs_compat"]
    	main = "@tanstack/react-start/server-entry"
    	[observability]
    	enabled = true
    ```
		</WranglerConfig>

2. Install `wrangler` as a development dependency:

   <PackageManagers dev pkg="wrangler@latest" />

3. Install the `@cloudflare/vite-plugin` package as a dependency:

   <PackageManagers type="add" pkg="@cloudflare/vite-plugin@latest" />

4. Update your `vite.config.ts` file to include the Cloudflare Vite plugin:

   ```ts title="vite.config.ts"
   import { defineConfig } from "vite";
   import { cloudflare } from "@cloudflare/vite-plugin";
   ...

   export default defineConfig({
   	plugins: [cloudflare({ viteEnvironment: { name: 'ssr' } }), ...],
   	// ... other configurations
   });
   ```

5. Update the `scripts` section of your `package.json` file to include the following commands:

   ```jsonc title="package.json"
   "scripts": {
   	...
   	"deploy": "npm run build && wrangler deploy",
   	"preview": "npm run build && vite preview",
   	"cf-typegen": "wrangler types"
   }
   ```

</Steps>

## Deploy your Project

You can deploy your project to a `*.workers.dev` subdomain or a [Custom Domain](/workers/configuration/routing/custom-domains/) from your own machine or from any CI/CD system, including Cloudflare's own [Workers Builds](/workers/ci-cd/builds/).

The following command will build and deploy your project. If you are using CI, ensure you update your [**Deploy command**](/workers/ci-cd/builds/configuration/#build-settings) configuration appropriately.

<PackageManagers type="run" args={"deploy"} />

:::note

Before deploying your application, you can also run the `preview` script to preview the built output locally before deploying it.
This can help you making sure that your application will work as intended once it's been deployed to the Cloudflare network:

<PackageManagers type="run" args="preview" />

:::

## Bindings

Your TanStack Start application can be fully integrated with the Cloudflare Developer Platform, in both local development and in production, by using bindings.

You can use bindings simply by [importing the `env` object](https://developers.cloudflare.com/workers/runtime-apis/bindings/#importing-env-as-a-global) and accessing it in your server
side code.

For example in the following way:

```tsx
import { createFileRoute } from "@tanstack/react-router";
import { createServerFn } from "@tanstack/react-start";
import { env } from "cloudflare:workers";

export const Route = createFileRoute("/")({
	loader: () => getData(),
	component: RouteComponent,
});

const getData = createServerFn().handler(() => {
	// Use env here
});

function RouteComponent() {
	// ...
}
```

:::note

Running the `cf-typegen` script:

<PackageManagers type="run" args="cf-typegen" />

Will populate the `env` object with the various bindings based on your configuration.

:::

<Render file="frameworks-bindings" product="workers" />

## Static Prerendering

You can prerender your application to static HTML files at build time with TanStack Start and serve them as [static assets](/workers/static-assets/).

```ts title="vite.config.ts"
import { defineConfig } from "vite";
import { cloudflare } from "@cloudflare/vite-plugin";
import { tanstackStart } from '@tanstack/react-start/plugin/vite'

export default defineConfig({
  plugins: [
    cloudflare({ viteEnvironment: { name: "ssr" } }),
    tanstackStart({
      prerender: {
        // Enable static prerendering
        enabled: true,
        // other prerender options...
      },
    }),
  ],
})
```

No additional configuration is needed in your wrangler config file. For more prerender options, see the [TanStack Start documentation](https://tanstack.com/start/latest/docs/framework/react/guide/static-prerendering).

:::note

Requires `@tanstack/react-start` v1.138.0 or later.

:::

:::caution

Prerendering runs during the build step and uses your local environment variables, secrets, and bindings storage data. Ensure your build environment is configured correctly, and use [remote bindings](/workers/development-testing/#remote-bindings) to prerender with production data.

:::

### Prerendering in CI environments

When prerendering in CI, your Worker code may need access to environment variables or secrets that are not available in the build environment. One way to handle this is to include a `.env` file with variable references, which resolve to values provided by your CI environment:
																								
```sh title=".env"
API_KEY=${API_KEY}
DATABASE_URL=${DATABASE_URL}
```

In your CI environment, set `CLOUDFLARE_INCLUDE_PROCESS_ENV=true` and provide the required values as environment variables. If using [Workers Builds](/workers/ci-cd/builds/), update your [build settings](/workers/ci-cd/builds/configuration/#build-settings) accordingly.

:::note

For local development, create a `.env.local` file with actual secret values. Do not commit this file to your repository. Values in `.env.local` override the references in `.env`:

```sh title=".env.local"                                                                                                                                         
API_KEY=my-local-dev-key                                                                                                                                   
DATABASE_URL=postgres://localhost/mydb                                                                                                                     
```

:::